(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[694],{103:()=>{},334:(e,t,a)=>{Promise.resolve().then(a.bind(a,711)),Promise.resolve().then(a.t.bind(a,394,23)),Promise.resolve().then(a.bind(a,571))},394:()=>{},571:(e,t,a)=>{"use strict";a.r(t),a.d(t,{CatalogItems:()=>i});var s=a(5155);a(2115),a(103);var c=a(5826),r=a(4007);let i=()=>{let{items:e}=(0,r.Us)(),{cartItems:t,onAddToCart:a}=(0,r.Us)(),{activeCategory:i,setActiveCategory:n}=(0,r.Us)(),o=i?e.filter(e=>e.category===i):e;return(0,s.jsx)("section",{className:"Products",children:(0,s.jsxs)("div",{className:"container",children:[(0,s.jsx)("span",{children:"Популярные товары"}),(0,s.jsx)("div",{className:"tovary",children:o.map(e=>(0,s.jsx)(c.j,{...e},e.id))})]})})}},711:(e,t,a)=>{"use strict";a.d(t,{default:()=>r});var s=a(5155);a(7499),a(2115);var c=a(1955);let r=()=>{let{activeCategory:e,setActiveCategory:t}=(0,c.Us)(),a=e=>{t(e)};return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"container",children:[(0,s.jsx)("div",{className:"catspan",children:(0,s.jsx)("span",{children:"Категории"})}),(0,s.jsxs)("div",{className:"categories",children:[(0,s.jsx)("button",{onClick:()=>a(""),className:""===e?"active":"",children:"Все"}),(0,s.jsx)("button",{onClick:()=>a("Акустическая гитара"),className:"Акустическая гитара"===e?"active":"",children:"Акустические гитары"}),(0,s.jsx)("button",{onClick:()=>a("Электрогитара"),className:"Электрогитара"===e?"active":"",children:"Электрогитары"}),(0,s.jsx)("button",{onClick:()=>a("Классическая гитара"),className:"Классическая гитара"===e?"active":"",children:"Классические гитары"}),(0,s.jsx)("button",{onClick:()=>a("Усилители для гитар"),className:"Усилители для гитар"===e?"active":"",children:"Усилители для гитар"}),(0,s.jsx)("button",{onClick:()=>a("Цифровое пианино"),className:"Цифровое пианино"===e?"active":"",children:"Цифровое пианино"}),(0,s.jsx)("button",{onClick:()=>a("Барабаны"),className:"Барабаны"===e?"active":"",children:"Барабаны"})]})]})})}},1955:(e,t,a)=>{"use strict";a.d(t,{MI:()=>o,ob:()=>u,Us:()=>d});var s=a(5155),c=a(2115),r=a(3464);function i(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)e[s]=a[s]}return e}var n=function e(t,a){function s(e,s,c){if("undefined"!=typeof document){"number"==typeof(c=i({},a,c)).expires&&(c.expires=new Date(Date.now()+864e5*c.expires)),c.expires&&(c.expires=c.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var r="";for(var n in c)c[n]&&(r+="; "+n,!0!==c[n]&&(r+="="+c[n].split(";")[0]));return document.cookie=e+"="+t.write(s,e)+r}}return Object.create({set:s,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var a=document.cookie?document.cookie.split("; "):[],s={},c=0;c<a.length;c++){var r=a[c].split("="),i=r.slice(1).join("=");try{var n=decodeURIComponent(r[0]);if(s[n]=t.read(i,n),e===n)break}catch(e){}}return e?s[e]:s}},remove:function(e,t){s(e,"",i({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,i({},this.attributes,t))},withConverter:function(t){return e(i({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(a)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});let o=(0,c.createContext)(null),l="https://673876654eb22e24fca800c5.mockapi.io",u=e=>{let{children:t}=e,[a,i]=(0,c.useState)([]),[u,d]=(0,c.useState)([]),[m,v]=(0,c.useState)(!0),[f,h]=(0,c.useState)(null),[p,x]=(0,c.useState)(""),[b,j]=(0,c.useState)([]),C=(null==u?void 0:u.map(e=>({...e,price:Number(e.price)})))||[];(0,c.useEffect)(()=>{let e=n.get("favorites");if(e)try{j(JSON.parse(e))}catch(e){console.error("Ошибка при загрузке избранного:",e)}},[]),(0,c.useEffect)(()=>{b.length>0?n.set("favorites",JSON.stringify(b),{expires:30}):n.remove("favorites")},[b]);let g=(0,c.useCallback)(e=>{j(t=>t.some(t=>t.id===e.id)?t:[...t,e])},[]),N=(0,c.useCallback)(e=>{j(t=>t.filter(t=>t.id!==e))},[]),y=(0,c.useCallback)(e=>b.some(t=>t.id===e),[b]),k=(0,c.useCallback)(async()=>{v(!0),h(null);try{let[e,t]=await Promise.allSettled([r.A.get("".concat(l,"/items")),r.A.get("".concat(l,"/cart"))]);"fulfilled"===e.status&&i(e.value.data),"fulfilled"===t.status&&d(t.value.data)}catch(e){h("Ошибка при загрузке данных!")}finally{v(!1)}},[]);(0,c.useEffect)(()=>{k()},[k]);let w=async e=>{try{let{data:t}=await r.A.post("".concat(l,"/items"),e);i(e=>[...e,t])}catch(e){console.error("Ошибка при добавлении товара:",e)}},U=async(e,t)=>{try{let{data:a}=await r.A.put("".concat(l,"/items/").concat(e),t);i(t=>t.map(t=>t.id===e?{...t,...a}:t))}catch(e){h("Ошибка при обновлении товара.")}},A=async e=>{try{await r.A.delete("".concat(l,"/items/").concat(e)),i(t=>t.filter(t=>t.id!==e))}catch(e){h("Ошибка при удалении товара.")}},I=(0,c.useCallback)(async e=>{try{let t=u.find(t=>t.title===e.title);if(t){let e={...t,quantity:t.quantity+1};await r.A.put("https://673876654eb22e24fca800c5.mockapi.io/cart/".concat(t.id),e),d(a=>a.map(a=>a.id===t.id?e:a))}else{let t={...e,quantity:1},{data:a}=await r.A.post("https://673876654eb22e24fca800c5.mockapi.io/cart",t);d(e=>[...e,a])}}catch(e){console.error("Ошибка при добавлении товара в корзину:",e)}},[u]),S=async e=>{try{let t=u.find(t=>t.id===e);if(!t)return;if(t.quantity>1){let a={...t,quantity:t.quantity-1};await r.A.put("https://673876654eb22e24fca800c5.mockapi.io/cart/".concat(e),a),d(t=>t.map(t=>t.id===e?a:t))}else await r.A.delete("https://673876654eb22e24fca800c5.mockapi.io/cart/".concat(e)),d(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Ошибка при обновлении количества товара:",e)}};return(0,s.jsxs)(o.Provider,{value:{items:a,cartItems:u,processedItems:C,addProduct:w,updateProduct:U,deleteProduct:A,onAddToCart:I,onRemoveItem:S,isItemInCart:e=>u.some(t=>t.title===e),activeCategory:p,setActiveCategory:x,loading:m,error:f,favorites:b,addToFavorites:g,removeFromFavorites:N,isItemInFavorites:y},children:[m?(0,s.jsx)("span",{className:"loader"}):t,f&&(0,s.jsx)("p",{style:{color:"red"},children:f})]})},d=()=>{let e=(0,c.useContext)(o);if(!e)throw Error("useContext must be inside a Provider with a value");return e}},4007:(e,t,a)=>{"use strict";a.d(t,{ob:()=>s.ob,Us:()=>s.Us});var s=a(1955)},5826:(e,t,a)=>{"use strict";a.d(t,{j:()=>n});var s=a(5155);a(2115);var c=a(4007),r=a(6874),i=a.n(r);function n(e){let{id:t,imageUrl:a,category:r,title:n,price:o=0}=e,{onAddToCart:l,isItemInCart:u,addToFavorites:d,removeFromFavorites:m,isItemInFavorites:v}=(0,c.Us)(),f=u(n),h=v(t),p=()=>{l({id:t,imageUrl:a,category:r,title:n,price:o})},x=(Number(o)||0).toLocaleString("ru-RU");return(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)(i(),{href:"/tovar/".concat(encodeURIComponent(n)),children:(0,s.jsx)("button",{className:"img",children:(0,s.jsx)("img",{src:a,alt:"products"})})}),(0,s.jsx)("button",{onClick:()=>{h?m(t):d({id:t,imageUrl:a,category:r,title:n,price:o})},className:"favorite-button",children:h?(0,s.jsx)("img",{className:"img5",src:"/icons/onFavourite.svg",alt:"Remove from Favorites"}):(0,s.jsx)("img",{className:"img5",src:"/icons/favourite.svg",alt:"Add to Favorites"})}),(0,s.jsx)("p",{children:r}),(0,s.jsx)("a",{children:n}),(0,s.jsxs)("b",{children:[x," ₽."]}),(0,s.jsx)("button",{className:"add",children:f?(0,s.jsx)(i(),{href:"/cart",children:(0,s.jsx)("img",{className:"img2",src:"/pictures/inCart.svg",alt:"In Cart"})}):(0,s.jsx)("button",{onClick:()=>p(),children:(0,s.jsx)("img",{className:"img2",src:"/pictures/toCart.svg",alt:"Add to Cart"})})})]},t)}},7499:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[402,710,464,874,441,684,358],()=>t(334)),_N_E=e.O()}]);