(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{1955:(e,t,r)=>{"use strict";r.d(t,{MI:()=>l,ob:()=>d,Us:()=>u});var a=r(5155),s=r(2115),i=r(3464);function n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)e[a]=r[a]}return e}var c=function e(t,r){function a(e,a,s){if("undefined"!=typeof document){"number"==typeof(s=n({},r,s)).expires&&(s.expires=new Date(Date.now()+864e5*s.expires)),s.expires&&(s.expires=s.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var c in s)s[c]&&(i+="; "+c,!0!==s[c]&&(i+="="+s[c].split(";")[0]));return document.cookie=e+"="+t.write(a,e)+i}}return Object.create({set:a,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],a={},s=0;s<r.length;s++){var i=r[s].split("="),n=i.slice(1).join("=");try{var c=decodeURIComponent(i[0]);if(a[c]=t.read(n,c),e===c)break}catch(e){}}return e?a[e]:a}},remove:function(e,t){a(e,"",n({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,n({},this.attributes,t))},withConverter:function(t){return e(n({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});let l=(0,s.createContext)(null),o="https://673876654eb22e24fca800c5.mockapi.io",d=e=>{let{children:t}=e,[r,n]=(0,s.useState)([]),[d,u]=(0,s.useState)([]),[h,f]=(0,s.useState)(!0),[m,p]=(0,s.useState)(null),[v,x]=(0,s.useState)(""),[j,g]=(0,s.useState)([]),b=(null==d?void 0:d.map(e=>({...e,price:Number(e.price)})))||[];(0,s.useEffect)(()=>{let e=c.get("favorites");if(e)try{g(JSON.parse(e))}catch(e){console.error("Ошибка при загрузке избранного:",e)}},[]),(0,s.useEffect)(()=>{j.length>0?c.set("favorites",JSON.stringify(j),{expires:30}):c.remove("favorites")},[j]);let y=(0,s.useCallback)(e=>{g(t=>t.some(t=>t.id===e.id)?t:[...t,e])},[]),w=(0,s.useCallback)(e=>{g(t=>t.filter(t=>t.id!==e))},[]),_=(0,s.useCallback)(e=>j.some(t=>t.id===e),[j]),N=(0,s.useCallback)(async()=>{f(!0),p(null);try{let[e,t]=await Promise.allSettled([i.A.get("".concat(o,"/items")),i.A.get("".concat(o,"/cart"))]);"fulfilled"===e.status&&n(e.value.data),"fulfilled"===t.status&&u(t.value.data)}catch(e){p("Ошибка при загрузке данных!")}finally{f(!1)}},[]);(0,s.useEffect)(()=>{N()},[N]);let C=async e=>{try{let{data:t}=await i.A.post("".concat(o,"/items"),e);n(e=>[...e,t])}catch(e){console.error("Ошибка при добавлении товара:",e)}},k=async(e,t)=>{try{let{data:r}=await i.A.put("".concat(o,"/items/").concat(e),t);n(t=>t.map(t=>t.id===e?{...t,...r}:t))}catch(e){p("Ошибка при обновлении товара.")}},A=async e=>{try{await i.A.delete("".concat(o,"/items/").concat(e)),n(t=>t.filter(t=>t.id!==e))}catch(e){p("Ошибка при удалении товара.")}},S=(0,s.useCallback)(async e=>{try{let t=d.find(t=>t.title===e.title);if(t){let e={...t,quantity:t.quantity+1};await i.A.put("https://673876654eb22e24fca800c5.mockapi.io/cart/".concat(t.id),e),u(r=>r.map(r=>r.id===t.id?e:r))}else{let t={...e,quantity:1},{data:r}=await i.A.post("https://673876654eb22e24fca800c5.mockapi.io/cart",t);u(e=>[...e,r])}}catch(e){console.error("Ошибка при добавлении товара в корзину:",e)}},[d]),I=async e=>{try{let t=d.find(t=>t.id===e);if(!t)return;if(t.quantity>1){let r={...t,quantity:t.quantity-1};await i.A.put("https://673876654eb22e24fca800c5.mockapi.io/cart/".concat(e),r),u(t=>t.map(t=>t.id===e?r:t))}else await i.A.delete("https://673876654eb22e24fca800c5.mockapi.io/cart/".concat(e)),u(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Ошибка при обновлении количества товара:",e)}};return(0,a.jsxs)(l.Provider,{value:{items:r,cartItems:d,processedItems:b,addProduct:C,updateProduct:k,deleteProduct:A,onAddToCart:S,onRemoveItem:I,isItemInCart:e=>d.some(t=>t.title===e),activeCategory:v,setActiveCategory:x,loading:h,error:m,favorites:j,addToFavorites:y,removeFromFavorites:w,isItemInFavorites:_},children:[h?(0,a.jsx)("span",{className:"loader"}):t,m&&(0,a.jsx)("p",{style:{color:"red"},children:m})]})},u=()=>{let e=(0,s.useContext)(l);if(!e)throw Error("useContext must be inside a Provider with a value");return e}},3826:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Providers:()=>d});var a=r(5155),s=r(1990);let i=(0,s.Z0)({name:"products",initialState:{products:{items:[],status:"loading"},category:{items:[],status:"loading"}},reducers:{}}).reducer;var n=r(6421);let c=(0,s.U1)({reducer:{products:i,auth:n.li}});var l=r(4007);r(2115);var o=r(4540);let d=e=>{let{children:t}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(o.Kq,{store:c,children:(0,a.jsx)(l.ob,{children:t})})})}},4007:(e,t,r)=>{"use strict";r.d(t,{ob:()=>a.ob,Us:()=>a.Us});var a=r(1955)},5688:e=>{e.exports={style:{fontFamily:"'Geist', 'Geist Fallback'",fontStyle:"normal"},className:"__className_5cfdac",variable:"__variable_5cfdac"}},5792:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,5688,23)),Promise.resolve().then(r.t.bind(r,9432,23)),Promise.resolve().then(r.t.bind(r,9324,23)),Promise.resolve().then(r.t.bind(r,9931,23)),Promise.resolve().then(r.bind(r,8823)),Promise.resolve().then(r.bind(r,3826))},6421:(e,t,r)=>{"use strict";r.d(t,{li:()=>f,tw:()=>i,Rd:()=>c,_D:()=>n,ri:()=>u,ZB:()=>d,BN:()=>o});var a=r(1990);let s=r(3464).A.create({baseURL:"http://localhost:3002"});s.interceptors.request.use(e=>(e.headers.Authorization=window.localStorage.getItem("token"),e));let i=(0,a.zD)("auth/fetchAuth",async(e,t)=>{let{rejectWithValue:r}=t;try{let t=await fetch("http://localhost:3002/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email,password:e.password})});if(!t.ok){let e=await t.json();return r(e)}return await t.json()}catch(e){return r(e.message)}}),n=(0,a.zD)("auth/fetchRegister",async(e,t)=>{let{rejectWithValue:r}=t;try{let{data:t}=await s.post("/api/auth/register",{email:e.email,password:e.password,confirmPassword:e.confirmPassword});return t}catch(e){var a;return r(null==(a=e.response)?void 0:a.data)}}),c=(0,a.zD)("auth/fetchAuthMe",async(e,t)=>{let{rejectWithValue:r}=t;try{let{data:e}=await s.get("/auth/me");return e}catch(e){return r(e.response.data)}}),l=(0,a.Z0)({name:"auth",initialState:{data:null,status:"idle",error:null},reducers:{logout:e=>{e.data=null,e.status="idle",e.error=null},clearError:e=>{e.error=null}},extraReducers:e=>{e.addMatcher(e=>e.type.endsWith("/pending"),e=>{e.status="loading",e.error=null}).addMatcher(e=>e.type.endsWith("/fulfilled"),(e,t)=>{e.status="succeeded",e.data=t.payload}).addMatcher(e=>e.type.endsWith("/rejected"),(e,t)=>{var r;e.status="failed",e.error=(null==(r=t.payload)?void 0:r.message)||"Произошла ошибка"})}}),o=e=>!!e.auth.data,d=e=>e.auth.error,{logout:u,clearError:h}=l.actions,f=l.reducer},6475:()=>{},8823:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Header:()=>l});var a=r(5155),s=r(6421),i=r(4540);r(2115),r(6475);var n=r(6874),c=r.n(n);function l(){let e=(0,i.wA)(),t=(0,i.d4)(s.BN);return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("header",{className:"header",children:(0,a.jsx)("div",{className:"container2",children:(0,a.jsxs)("div",{className:"header_row",children:[(0,a.jsxs)("div",{className:"header__logo",children:[(0,a.jsx)("img",{src:"/logo/NewLogo4.png",alt:"Logo"}),(0,a.jsxs)(c(),{href:"/",children:[" ",(0,a.jsxs)("span",{children:[(0,a.jsx)("a",{children:"AC"}),"CORD"]})]})]}),(0,a.jsx)("nav",{className:"header_nav",children:(0,a.jsxs)("ul",{children:[(0,a.jsx)("li",{children:(0,a.jsx)(c(),{href:"/new",children:"НОВИНКИ"})}),(0,a.jsx)("li",{children:(0,a.jsx)(c(),{href:"/catalog",children:"КАТАЛОГ"})}),(0,a.jsx)("li",{children:(0,a.jsx)(c(),{href:"/aboutUs",children:"МАГАЗИНЫ"})})]})}),(0,a.jsx)("div",{className:"header_nav_right",children:(0,a.jsx)("ul",{children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c(),{href:"/favourite",children:(0,a.jsxs)("button",{className:"trash_can",children:["Избранное",(0,a.jsx)("img",{src:"/icons/favourite.svg",alt:"can"})]})}),(0,a.jsx)(c(),{href:"/cart",children:(0,a.jsxs)("button",{className:"trash_can",children:["Корзина",(0,a.jsx)("img",{src:"/icons/cartIcon.png",alt:"can"})]})}),(0,a.jsxs)("div",{className:"user_profile",children:[(0,a.jsx)("button",{onClick:()=>{window.confirm("Вы уверены, что хотите выйти?")&&(e((0,s.ri)()),window.localStorage.removeItem("token"))},children:(0,a.jsx)(c(),{href:"/",children:(0,a.jsx)("button",{children:"Выйти"})})}),(0,a.jsx)(c(),{href:"/profile",children:(0,a.jsx)("img",{src:"/icons/profile.png",alt:"can"})})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c(),{href:"/favourite",children:(0,a.jsxs)("button",{className:"trash_can",children:["Избранное",(0,a.jsx)("img",{src:"/icons/favourite.svg",alt:"can"})]})}),(0,a.jsxs)("button",{className:"trash_can",children:[(0,a.jsx)(c(),{href:"/cart",children:"Корзина "}),(0,a.jsx)("img",{src:"/icons/cartIcon.png",alt:"can"})]}),(0,a.jsxs)("div",{className:"user_profile",children:[(0,a.jsx)("button",{children:(0,a.jsx)(c(),{href:"/login",children:"Войти"})}),(0,a.jsx)("img",{src:"/icons/profile.png",alt:"can"})]})]})})})]})})})})}},9324:()=>{},9432:e=>{e.exports={style:{fontFamily:"'Geist Mono', 'Geist Mono Fallback'",fontStyle:"normal"},className:"__className_9a8899",variable:"__variable_9a8899"}},9931:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[487,464,874,635,441,684,358],()=>t(5792)),_N_E=e.O()}]);