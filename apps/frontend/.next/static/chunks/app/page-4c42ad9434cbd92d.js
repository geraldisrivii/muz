(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{103:()=>{},274:()=>{},563:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,6874,23)),Promise.resolve().then(r.t.bind(r,3793,23)),Promise.resolve().then(r.t.bind(r,3899,23)),Promise.resolve().then(r.t.bind(r,274,23)),Promise.resolve().then(r.bind(r,571))},571:(e,t,r)=>{"use strict";r.r(t),r.d(t,{CatalogItems:()=>c});var a=r(5155);r(2115),r(103);var s=r(5826),i=r(4007);let c=()=>{let{items:e}=(0,i.Us)(),{cartItems:t,onAddToCart:r}=(0,i.Us)(),{activeCategory:c,setActiveCategory:n}=(0,i.Us)(),o=c?e.filter(e=>e.category===c):e;return(0,a.jsx)("section",{className:"Products",children:(0,a.jsxs)("div",{className:"container",children:[(0,a.jsx)("span",{children:"Популярные товары"}),(0,a.jsx)("div",{className:"tovary",children:o.map(e=>(0,a.jsx)(s.j,{...e},e.id))})]})})}},1955:(e,t,r)=>{"use strict";r.d(t,{MI:()=>o,ob:()=>u,Us:()=>d});var a=r(5155),s=r(2115),i=r(3464);function c(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)e[a]=r[a]}return e}var n=function e(t,r){function a(e,a,s){if("undefined"!=typeof document){"number"==typeof(s=c({},r,s)).expires&&(s.expires=new Date(Date.now()+864e5*s.expires)),s.expires&&(s.expires=s.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var n in s)s[n]&&(i+="; "+n,!0!==s[n]&&(i+="="+s[n].split(";")[0]));return document.cookie=e+"="+t.write(a,e)+i}}return Object.create({set:a,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var r=document.cookie?document.cookie.split("; "):[],a={},s=0;s<r.length;s++){var i=r[s].split("="),c=i.slice(1).join("=");try{var n=decodeURIComponent(i[0]);if(a[n]=t.read(c,n),e===n)break}catch(e){}}return e?a[e]:a}},remove:function(e,t){a(e,"",c({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,c({},this.attributes,t))},withConverter:function(t){return e(c({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});let o=(0,s.createContext)(null),l="https://673876654eb22e24fca800c5.mockapi.io",u=e=>{let{children:t}=e,[r,c]=(0,s.useState)([]),[u,d]=(0,s.useState)([]),[m,f]=(0,s.useState)(!0),[p,v]=(0,s.useState)(null),[h,b]=(0,s.useState)(""),[x,g]=(0,s.useState)([]),C=(null==u?void 0:u.map(e=>({...e,price:Number(e.price)})))||[];(0,s.useEffect)(()=>{let e=n.get("favorites");if(e)try{g(JSON.parse(e))}catch(e){console.error("Ошибка при загрузке избранного:",e)}},[]),(0,s.useEffect)(()=>{x.length>0?n.set("favorites",JSON.stringify(x),{expires:30}):n.remove("favorites")},[x]);let j=(0,s.useCallback)(e=>{g(t=>t.some(t=>t.id===e.id)?t:[...t,e])},[]),y=(0,s.useCallback)(e=>{g(t=>t.filter(t=>t.id!==e))},[]),k=(0,s.useCallback)(e=>x.some(t=>t.id===e),[x]),N=(0,s.useCallback)(async()=>{f(!0),v(null);try{let[e,t]=await Promise.allSettled([i.A.get("".concat(l,"/items")),i.A.get("".concat(l,"/cart"))]);"fulfilled"===e.status&&c(e.value.data),"fulfilled"===t.status&&d(t.value.data)}catch(e){v("Ошибка при загрузке данных!")}finally{f(!1)}},[]);(0,s.useEffect)(()=>{N()},[N]);let w=async e=>{try{let{data:t}=await i.A.post("".concat(l,"/items"),e);c(e=>[...e,t])}catch(e){console.error("Ошибка при добавлении товара:",e)}},U=async(e,t)=>{try{let{data:r}=await i.A.put("".concat(l,"/items/").concat(e),t);c(t=>t.map(t=>t.id===e?{...t,...r}:t))}catch(e){v("Ошибка при обновлении товара.")}},A=async e=>{try{await i.A.delete("".concat(l,"/items/").concat(e)),c(t=>t.filter(t=>t.id!==e))}catch(e){v("Ошибка при удалении товара.")}},I=(0,s.useCallback)(async e=>{try{let t=u.find(t=>t.title===e.title);if(t){let e={...t,quantity:t.quantity+1};await i.A.put("https://673876654eb22e24fca800c5.mockapi.io/cart/".concat(t.id),e),d(r=>r.map(r=>r.id===t.id?e:r))}else{let t={...e,quantity:1},{data:r}=await i.A.post("https://673876654eb22e24fca800c5.mockapi.io/cart",t);d(e=>[...e,r])}}catch(e){console.error("Ошибка при добавлении товара в корзину:",e)}},[u]),S=async e=>{try{let t=u.find(t=>t.id===e);if(!t)return;if(t.quantity>1){let r={...t,quantity:t.quantity-1};await i.A.put("https://673876654eb22e24fca800c5.mockapi.io/cart/".concat(e),r),d(t=>t.map(t=>t.id===e?r:t))}else await i.A.delete("https://673876654eb22e24fca800c5.mockapi.io/cart/".concat(e)),d(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Ошибка при обновлении количества товара:",e)}};return(0,a.jsxs)(o.Provider,{value:{items:r,cartItems:u,processedItems:C,addProduct:w,updateProduct:U,deleteProduct:A,onAddToCart:I,onRemoveItem:S,isItemInCart:e=>u.some(t=>t.title===e),activeCategory:h,setActiveCategory:b,loading:m,error:p,favorites:x,addToFavorites:j,removeFromFavorites:y,isItemInFavorites:k},children:[m?(0,a.jsx)("span",{className:"loader"}):t,p&&(0,a.jsx)("p",{style:{color:"red"},children:p})]})},d=()=>{let e=(0,s.useContext)(o);if(!e)throw Error("useContext must be inside a Provider with a value");return e}},3793:()=>{},3899:()=>{},4007:(e,t,r)=>{"use strict";r.d(t,{ob:()=>a.ob,Us:()=>a.Us});var a=r(1955)},5826:(e,t,r)=>{"use strict";r.d(t,{j:()=>n});var a=r(5155);r(2115);var s=r(4007),i=r(6874),c=r.n(i);function n(e){let{id:t,imageUrl:r,category:i,title:n,price:o=0}=e,{onAddToCart:l,isItemInCart:u,addToFavorites:d,removeFromFavorites:m,isItemInFavorites:f}=(0,s.Us)(),p=u(n),v=f(t),h=()=>{l({id:t,imageUrl:r,category:i,title:n,price:o})},b=(Number(o)||0).toLocaleString("ru-RU");return(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)(c(),{href:"/tovar/".concat(encodeURIComponent(n)),children:(0,a.jsx)("button",{className:"img",children:(0,a.jsx)("img",{src:r,alt:"products"})})}),(0,a.jsx)("button",{onClick:()=>{v?m(t):d({id:t,imageUrl:r,category:i,title:n,price:o})},className:"favorite-button",children:v?(0,a.jsx)("img",{className:"img5",src:"/icons/onFavourite.svg",alt:"Remove from Favorites"}):(0,a.jsx)("img",{className:"img5",src:"/icons/favourite.svg",alt:"Add to Favorites"})}),(0,a.jsx)("p",{children:i}),(0,a.jsx)("a",{children:n}),(0,a.jsxs)("b",{children:[b," ₽."]}),(0,a.jsx)("button",{className:"add",children:p?(0,a.jsx)(c(),{href:"/cart",children:(0,a.jsx)("img",{className:"img2",src:"/pictures/inCart.svg",alt:"In Cart"})}):(0,a.jsx)("button",{onClick:()=>h(),children:(0,a.jsx)("img",{className:"img2",src:"/pictures/toCart.svg",alt:"Add to Cart"})})})]},t)}}},e=>{var t=t=>e(e.s=t);e.O(0,[571,710,464,874,441,684,358],()=>t(563)),_N_E=e.O()}]);